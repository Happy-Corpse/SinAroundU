<!DOCTYPE html>
<html lang="en">
<head>
	<!-- Cloud Computing -->
	<title>Home</title>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>	
	<link rel="stylesheet" href="css/styles.css"/>
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<script type="text/javascript">
        function ReadCookie(cookie_name){
            if (document.cookie.length > 0){
                cookie_start = document.cookie.indexOf(cookie_name + "=")
                if (cookie_start != -1){
                    cookie_start = cookie_start + cookie_name.length + 1
                    cookie_end = document.cookie.indexOf(";", cookie_start)
                    if (cookie_end == -1) {
                        cookie_end = document.cookie.length
                    }
                    return unescape(document.cookie.substring(cookie_start,cookie_end))
                }
            }
            return ""
        }

	function callAPI(){
		var obj;
		const api_url =  "https://01ozkfi1g8.execute-api.us-east-1.amazonaws.com/dev";
		// instantiate a headers object
		var district_id = ReadCookie("username");
        var facility = document.querySelector('.messageCheckbox:checked').value;
		var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");
		var raw = JSON.stringify({"district":district_id, "facility":facility});
		console.log(raw);
		// create a JSON object with parameters for API call and store in a variable
		document.getElementById("msg3").innerHTML = raw;
		var requestOptions = {
			method: 'POST',
			headers: myHeaders,
			body: raw,
			redirect: 'follow'
		};
		loadData(requestOptions);
        }
		async function getResult(data){
                let myData = await data;
                let finalData = JSON.parse(myData);
                console.log(finalData);
                document.getElementById("msg2").innerHTML = finalData.result;
            }

		async function loadData(requestOptions){
			fetch("https://01ozkfi1g8.execute-api.us-east-1.amazonaws.com/dev", requestOptions)
			.then(response => obj = response.text())
			.then(result => getResult(obj));
		}
    </script>
</head>

<body>
<div class="nav" id="nav-main">
	<img src = "img/logo2.png" id = "logo">
	<ul id="navbar">
	<li><a href="index.html" id="nav_home">HOME</a></li>
	<li><a href="about-us.html" id="About-us">About-us</a></li>
	<li><a href="https://www.comp.nus.edu.sg/~teoym/cs5224-22/schedule.html" id="Contact">Contact Us</a></li>
	</ul>
</div>
<main id="mainmain">
	<div id="sidebar" class="flex-shrink-0 p-3 bg-white">
		<a class="d-flex align-items-center pb-3 mb-3 link-dark text-decoration-none border-bottom">
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
  				<path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
			</svg>
			<span class="fs-5 fw-semibold">Filter</span>
		</a>
		<ul class="list-unstyled ps-0">
			<li class="mb-1">
				<button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse"
						data-bs-target="#home-collapse" aria-expanded="true">
					District
				</button>
				<div class="collapse show" id="home-collapse">
					<fieldset>
						<label for="01" class="container">District 01 - Raffles Place, Marina, Cecil
							<input type="radio" id="01" name="district" value="Raffles Place, Marina, Cecil">
							<span class="checkmark"></span>
						</label><br>
						<label for="02" class="container">District 02 - Tanjong Pagar, Chinatown
							<input type="radio" id="02" name="district" value="Tanjong Pagar, Chinatown">
							<span class="checkmark"></span>
						</label><br>
						<label for="03" class="container">District 03 - Tiong Bahru, Alexandra, Queenstown
							<input type="radio" id="03" name="district" value="Tiong Bahru, Alexandra, Queenstown">
							<span class="checkmark"></span>
						</label><br>
						<label for="04" class="container">District 04 - Mount Faber, Telok Blangah, Harbourfront
							<input type="radio" id="04" name="district" value="Mount Faber, Telok Blangah, Harbourfront">
							<span class="checkmark"></span>
						</label><br>
						<label for="05" class="container">District 05 - Buona Vista, Pasir Panjang, Clementi
							<input type="radio" id="05" name="district" value="Buona Vista, Pasir Panjang, Clementi">
							<span class="checkmark"></span>
						</label><br>
						<label for="06" class="container">District 06 - Clarke Quay, City Hall
							<input type="radio" id="06" name="district" value="Clarke Quay, City Hall">
							<span class="checkmark"></span>
						</label><br>
						<label for="07" class="container">District 07 - Bugis, Beach Road, Golden Mile
							<input type="radio" id="07" name="district" value="Bugis, Beach Road, Golden Mile">
							<span class="checkmark"></span>
						</label><br>
						<label for="08" class="container">District 08 - Little India, Farrer Park
							<input type="radio" id="08" name="district" value="Little India, Farrer Park">
							<span class="checkmark"></span>
						</label><br>
						<label for="09" class="container">District 09 - Orchard Road, River Valley
							<input type="radio" id="09" name="district" value="Orchard Road, River Valley">
							<span class="checkmark"></span>
						</label><br>
						<label for="10" class="container">District 10 - Bukit Timah, Holland, Balmoral
							<input type="radio" id="10" name="district" value="Bukit Timah, Holland, Balmoral">
							<span class="checkmark"></span>
						</label><br>
						<label for="11" class="container">District 11 - Novena, Newton, Thomson
							<input type="radio" id="11" name="district" value="Novena, Newton, Thomson">
							<span class="checkmark"></span>
						</label><br>
						<label for="12" class="container">District 12 - Toa Payoh, Serangoon, Balestier
							<input type="radio" id="12" name="district" value="Toa Payoh, Serangoon, Balestier">
							<span class="checkmark"></span>
						</label><br>
						<label for="13" class="container">District 13 - Macpherson, Braddell
							<input type="radio" id="13" name="district" value="Macpherson, Braddell">
							<span class="checkmark"></span>
						</label><br>
						<label for="14" class="container">District 14 - Geylang, Paya Lebar, Sims
							<input type="radio" id="14" name="district" value="Geylang, Paya Lebar, Sims">
							<span class="checkmark"></span>
						</label><br>
						<label for="15" class="container">District 15 - Joo Chiat, Marina Parade, Katong
							<input type="radio" id="15" name="district" value="Joo Chiat, Marina Parade, Katong">
							<span class="checkmark"></span>
						</label><br>
						<label for="16" class="container">District 16 - Bedok, Upper East Coast, Siglap
							<input type="radio" id="16" name="district" value="Bedok, Upper East Coast, Siglap">
							<span class="checkmark"></span>
						</label><br>
						<label for="17" class="container">District 17 - Changi, Flora, Loyang
							<input type="radio" id="17" name="district" value="Changi, Flora, Loyang">
							<span class="checkmark"></span>
						</label><br>
						<label for="18" class="container">District 18 - Tampines, Pasir Ris
							<input type="radio" id="18" name="district" value="Tampines, Pasir Ris">
							<span class="checkmark"></span>
						</label><br>
						<label for="19" class="container">District 19 - Punggol, Sengkang, Serangoon Gardens
							<input type="radio" id="19" name="district" value="Punggol, Sengkang, Serangoon Gardens">
							<span class="checkmark"></span>
						</label><br>
						<label for="20" class="container">District 20 - Ang Mo Kio, Bishan, Thomson
							<input type="radio" id="20" name="district" value="Ang Mo Kio, Bishan, Thomson">
							<span class="checkmark"></span>
						</label><br>
						<label for="21" class="container">District 21 - Upper Bukit Timah, Ulu Pandan, Clementi Park
							<input type="radio" id="21" name="district"
								   value="Upper Bukit Timah, Ulu Pandan, Clementi Park">
							<span class="checkmark"></span>
						</label><br>
						<label for="22" class="container">District 22 - Boon Lay, Jurong, Tuas
							<input type="radio" id="22" name="district" value="Boon Lay, Jurong, Tuas">
							<span class="checkmark"></span>
						</label><br>
						<label for="23" class="container">District 23 - Choa Chu Kang, Diary Farm, Hillview, Bukit Panjang,
							Bukit Batok
							<input type="radio" id="23" name="district"
								   value="Choa Chu Kang, Diary Farm, Hillview, Bukit Panjang, Bukit Batok">
							<span class="checkmark"></span>
						</label><br>
						<label for="24" class="container">District 24 - Kranji, Lim Chu Kang, Tengah
							<input type="radio" id="24" name="district" value="Kranji, Lim Chu Kang, Tengah">
							<span class="checkmark"></span>
						</label><br>
						<label for="25" class="container">District 25 - Woodlands, Admiralty
							<input type="radio" id="25" name="district" value="Woodlands, Admiralty">
							<span class="checkmark"></span>
						</label><br>
						<label for="26" class="container">District 26 - Upper Thomson, Mandai
							<input type="radio" id="26" name="district" value="Upper Thomson, Mandai">
							<span class="checkmark"></span>
						</label><br>
						<label for="27" class="container">District 27 - Sembawang, Yishun, Admiralty
							<input type="radio" id="27" name="district" value="Sembawang, Yishun, Admiralty">
							<span class="checkmark"></span>
						</label><br>
						<label for="28" class="container">District 28 - Yio Chu Kang, Seletar
							<input type="radio" id="28" name="district" value="Yio Chu Kang, Seletar">
							<span class="checkmark"></span>
						</label><br>
					</fieldset>
				</div>
			</li>
			<li class="mb-1">
				<button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse"
						data-bs-target="#dashboard-collapse" aria-expanded="false">
					Facility
				</button>
				<div class="collapse" id="dashboard-collapse">
					<fieldset id="facilitychoice">
						<label class="container">HDB Carpark
							<input class = "messageCheckbox" type="radio" name="facility" value="Carpark" onclick = "callAPI()">
							<span class="checkmark"></span>
						</label><br>
						<label class="container">Preschool Center
							<input class = "messageCheckbox" type="radio" name="facility" value="Preschool" onclick = "callAPI()" >
							<span class="checkmark"></span>
						</label><br>
						<label class="container">Hawker Centers
							<input class = "messageCheckbox" type="radio" name="facility" value="Hawker" checked onclick = "callAPI()">
							<span class="checkmark"></span>
						</label><br>
						<label class="container">Median Rent by Town and Flat
							<input class = "messageCheckbox" id="MedianRent" type="radio" name="facility" value="MedianRent" onclick = "callAPI()">
							<span class="checkmark"></span>
						</label><br>
						<label class="container">Parks
							<input class = "messageCheckbox" type="radio" name="facility" value="Park" onclick = "callAPI()">
							<span class="checkmark"></span>
						</label><br>
						<label class="container">Renting Out Of Flats
							<input class = "messageCheckbox" id="RentFlat" type="radio" name="facility" value="RentFlat" onclick = "callAPI()">
							<span class="checkmark"></span>
						</label><br>
						<label class="container">Resale Flat Prices
							<input class = "messageCheckbox" id="ResaleFlat" type="radio" name="facility" value="ResaleFlat" onclick = "callAPI()">
							<span class="checkmark"></span>
						</label><br>
					</fieldset>
				</div>
			</li>
		</ul>
	</div>
	<div id="maindata">
		<div id="map"></div>
		<div class="row align-items-md-stretch">
			<div class="col-md-6">
				<div class="h-100 p-5 text-white bg-dark rounded-3">
					<h2>Change the background</h2>
					<p>Swap the background-color utility and add a `.text-*` color utility to mix up the jumbotron look.
						Then, mix and match with additional component themes and more.</p>
				</div>
			</div>
			<div class="col-md-6">
				<div class="h-100 p-5 text-white bg-dark rounded-3">
					<h2>Change the background</h2>
					<p>Swap the background-color utility and add a `.text-*` color utility to mix up the jumbotron look.
						Then, mix and match with additional component themes and more.</p>
				</div>
			</div>
			<div class="col-md-6">
				<div class="h-100 p-5 text-white bg-dark rounded-3">
					<h2>Change the background</h2>
					<p>Swap the background-color utility and add a `.text-*` color utility to mix up the jumbotron look.
						Then, mix and match with additional component themes and more.</p>
				</div>
			</div>
			<div class="col-md-6">
				<div class="h-100 p-5 text-white bg-dark rounded-3">
					<h2>Test 1</h2>
						<body onload="callAPI()">
						<div id="msg2">Pending  Test 1. . .</div>
						<div id="msg3">Pending  Test 2. . .</div>
				</div>
			</div>
		</div>
	</div>
</main>

<!--<div class = "pagebottom">-->
<!--	<footer>-->
<!--		&copy; SinAroundU +65 12345678-->
<!--	</footer>-->
<!--</div>-->

<script src="js/js/bootstrap.bundle.min.js"></script>
<script src="js/js/sidebars.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDbg_6GKSfuEgUpss4pMe47cpXmkjILJ_I&callback=initMap" async></script>
<!--<script src="http://maps.google.com/maps/api/js?key=AIzaSyDbg_6GKSfuEgUpss4pMe47cpXmkjILJ_I" type="text/javascript"></script>-->
</body>

<script language="JavaScript">
	function toggle_district(source) {
		checkboxes = document.getElementsByName('district');
		for(var i=0, n=checkboxes.length;i<n;i++) {
    		checkboxes[i].checked = source.checked;
		}
	}

	function toggle_facility(source) {
		checkboxes = document.getElementsByName('facility');
		for(var i=0, n=checkboxes.length;i<n;i++) {
    		checkboxes[i].checked = source.checked;
		}
	}

	function initMap() {
		// content to be displayed by click and location
		var locations = [
			['Bondi Beach', -33.890542, 151.274856, 4],
			['Coogee Beach', -33.923036, 151.259052, 5],
			['Cronulla Beach', -34.028249, 151.157507, 3],
			['Manly Beach', -33.80010128657071, 151.28747820854187, 2],
			['Maroubra Beach', -33.950198, 151.259302, 1]
		];

		// center of map shown
		var map = new google.maps.Map(document.getElementById('map'), {
			zoom: 10,
			center: new google.maps.LatLng(-33.92, 151.25),
			mapTypeId: google.maps.MapTypeId.ROADMAP
		});

		var infowindow = new google.maps.InfoWindow();
		var marker, i;

		for (i = 0; i < locations.length; i++) {
			marker = new google.maps.Marker({
				position: new google.maps.LatLng(locations[i][1], locations[i][2]),
				map: map
			});
			google.maps.event.addListener(marker, 'click', (function(marker, i) {
				return function() {
					infowindow.setContent(locations[i][0]);
					infowindow.open(map, marker);
				}
			})(marker, i));
		}
	}

</script>

</html>
